<!doctype html>
<html lang="pt-br">
<head>
	<meta charset="UTF-8">
	<title>PPL - Resolução Analítica</title>
	<script src="js/jquery-1.9.1.min.js"></script>
	<!--<script src='js/jquery.autosize.js'></script>-->
	<script src="js/simplex3.0.js"></script>
	<script src="js/objetos_2.js"></script> 
	<script src="js/mathml.js"></script>
	<link rel="stylesheet" href="css/css.css">
	
	<script>
		// Wait until the DOM has loaded before querying the document
		$(document).ready(function(){
		
		//========= TABS ========= //
			$('ul.tabs').each(function(){
				// For each set of tabs, we want to keep track of
				// which tab is active and it's associated content
				var $active, $content, $links = $(this).find('a');

				// If the location.hash matches one of the links, use that as the active tab.
				// If no match is found, use the first link as the initial active tab.
				$active = $($links.filter('[href="'+location.hash+'"]')[0] || $links[0]);
				$active.addClass('active');
				$content = $($active.attr('href'));

				// Hide the remaining content
				$links.not($active).each(function () {
					$($(this).attr('href')).hide();
				});

				// Bind the click event handler
				$(this).on('click', 'a', function(e){
					// Make the old tab inactive.
					$active.removeClass('active');
					$content.hide();

					// Update the variables with the new link and content
					$active = $(this);
					$content = $($(this).attr('href'));

					// Make the tab active.
					$active.addClass('active');
					$content.show();

					// Prevent the anchor's default click action
					e.preventDefault();
				});
			});	
			//========================//
			
			//======= AUTOSIZE =======//
			//$('.normal').autosize();
			//========================//
			
			//========= EXEMPLO ========= //
			$('#exemplo').on('click', function (){
				$('textarea#input').val('Max z = 5x1 + 5x2 + 3x3\nsujeito a\nx1 + 3x2 + x3 <= 3\n-x1 + 3x3<=2\n2x1 - x2 + 2x3 <= 4\n2x1 + 3x2 - x3 <= 2');
			});
			// =========================== //
			
			// ========= RESOLVE ========= //
			$('#enviar').on('click', function (){
				var string = tratar_string($("textarea").val());
				$('.formulario').hide();
				
				$('#inicial').append('<div class="problema"><h4>PPL</h4></div>');
				$('#inicial').append('<div class="dicionario"><h4>Dicionario Inicial</h4></div>');

				$('#inicial .footer').remove();
				
				var cr = unescape( "%0D" );	
				var arrayPPL = extrair_array_elementos(string,cr);
				
				var funcaoObjetivo = extrair_funcao_objetivo(arrayPPL);
				var restricoes = extrair_restricoes(arrayPPL);  
				
				problema = new Problema();
				problema.setFuncaoObjetivo(funcaoObjetivo);
				problema.setRestricoes(restricoes);
				
				criarPPL(problema);
				
				dicionario = new Dicionario();
				dicionario.setBase(problema.restricoes);
				dicionario.setFuncaoObjetivo(problema.funcaoObjetivo);
				dicionario.setRestricoesNn();
				dicionario.setSolucao();
				dicionario.setMaxZ();
				
				var iteracao = 0;
				
				criarMathDic(dicionario, iteracao);
				
				var solucao_otima = dicionario.funcaoObjetivo.verificarSolucao();
						
				while (solucao_otima !=1){
					iteracao++;
					$('.wrap').append('<div id="it'+iteracao+'" class="main" hidden></div>');
					$('ul.tabs').append('<li><a href="#it'+iteracao+'"> '+iteracao+'ª Iteração</a></li>');

					//ANALISE DAS FORCAS RESTRITIVAS
					$('#it'+iteracao+'').append('<div class="analise_fr"><h4>Forças Restritivas '+iteracao+'ª Iteração</h4></div>');
					dicionario.analise_ff(iteracao);
					
					//RECALCULO DAS EQUACOES
					$('#it'+iteracao+'').append('<div class="recalculo"><span><h4>Recalculo das equações da '+iteracao+'ª Iteração</h4></span></div>');
					dicionario.recalculoEquacoes(iteracao);
					
					dicionario.setSolucao();
					dicionario.setMaxZ();
					
					//DICIONARIO
					$('#it'+iteracao+'').append('<div class="dicionario"><h4>Dicionario '+iteracao+'ª Iteração</h4></div>');
					criarMathDic(dicionario, iteracao);
					
					//VERIFICAR SE A SOLUCAO É OTIMA
					solucao_otima = dicionario.funcaoObjetivo.verificarSolucao();
					
					$('#it'+iteracao+'').append('<div class="footer"></div>');
				}
				
				//$('#inicial').append('<div class="next">Executar a Primeira Iteração</div>');
				$('#inicial').append('<div class="footer"></div>');
				//$('math').attr('id','matematica');
				$('.next').on('click', function (){
					$('body').append('<div id="primeira" class="main" hidden>:)</div>');
					$('ul.tabs').append('<li><a href="#primeira"> 1ª Iteração</a></li>');
					
				});
				
			});
				
			// =========================== //
			
		});
		
		function novasAbas() {
			var qtd_novas_abas = $("div#inicial textarea#input").val();
			var abas_atuais = $("ul.tabs").find("a");
			var aux;
			
			for (var i=0; i < qtd_novas_abas;i++) {
				aux = abas_atuais.length + i;
				$("<li><a href='#tab"+aux+"'>"+aux+"ª Iteração</a></li>").appendTo("ul.tabs");
				$("<div id='tab"+aux+"' style='display: none;' class='main'><h3>"+aux+"ª Iteração</h3></div>").appendTo("body");
			}
			//$("#inicial .formulario").hide();
		}
	
		function esconderTextBox(){
			$("#inicial > form").hide();
			$("#inicial #ha").show();
		}

	</script>
	
</head>
<body>
	<div class="wrap">
		<h3>Programação Linear - Resolução Analítica</h3>
		<!-- ========================== -->
		<ul class='tabs'>
			<li><a href='#inicial' hidden>Inicial</a></li>
		</ul>

		<div id='inicial' class='main'>
			
			<div class="formulario">
				<form>
					<!--<label for="textarea">Insira o PPL:</label><br />-->
					<textarea class="normal" id="input" name="textarea"  placeholder="INSIRA AQUI O PPL OU CLIQUE NO BOTÃO EXEMPLO"></textarea>
				</form>
				<button type="button" class="but" id="enviar">Enviar</button>
				<button type="button" class="but" onclick="$('div#inicial textarea#input').val('')">Limpar</button>
				<button type="button" class="but" id="exemplo">Exemplo</button>
			</div>
			
			<div class='footer'></div>
		</div>
		<!-- ========================== -->
	</div>
</body>
</html>